<html>
  <head>
    <script type='text/javascript' src='https://cdn.staticfile.org/jquery/2.2.4/jquery.min.js'></script>
    <script type='text/javascript' src='https://cdn.staticfile.org/vue/2.2.6/vue.min.js'></script>
  </head>

  <body>
    <form id='app' action='/web-shield/config' method='post'>
      <h3>Whitelist IP</h3>
      <ul>
        <li v-for='ip in ip_shield.whitelist'>
          <input type='text' name='whitelist' v-model="ip" />
        </li>
      </ul>

      <h3>Blacklist IP</h3>
      <ul>
        <li v-for='ip in ip_shield.blacklist'>
          <input type='text' name='blacklist' v-model='ip' />
        </li>
      </ul>

      <h3>Whitelist PATH</h3>
      <ul>
        <li v-for='filter in path_whitelist_shield.threshold'>
          <input type='text' name='path_whitelist' v-bind:value="filter.matcher.method.join(',')" v-on:input="filter.matcher.method = $event.target.value.split(',')" />
          <input type='text' name='path_whitelist' v-model='filter.matcher.path' />
        </li>
      </ul>

      <h3>PATH Threshold</h3>
      <table>
        <thead>
          <tr>
            <th>Request Methods</th>
            <th>Path</th>
            <th>Period</th>
            <th>Limit</th>
          </tr>
        </thead>

        <tbody>
          <tr v-for='filter in path_shield.threshold'>
            <td>
              <input type='text' name='path_threshold' v-bind:value="filter.matcher.method.join(',')" v-on:input="filter.matcher.method = $event.target.value.split(',')" />
            </td>
            <td><input type='text' name='path_threshold' v-model='filter.matcher.path' /></td>
            <td><input type='text' name='path_threshold' v-model='filter.period' /></td>
            <td><input type='text' name='path_threshold' v-model='filter.limit' /></td>
          </li>
        </tbody>
      </table>


      <input type='submit' value='Update' />
    </form>

    <script type='text/javascript'>
      var app = new Vue({
        el: '#app',
        data: {
          shields: {},
          ip_shield: {whitelist: [], blacklist: []},
          path_whitelist_shield: {threshold: []},
          path_shield: {threshold: []}
        }
      });
      $.get('/web-shield/config', function(data, status, res){
        var shields = data.shields;
        app.shields = shields;
        app.ip_shield = shields[0].config;
        app.path_whitelist_shield = shields[1].config;
        app.path_shield = shields[2].config;
      });
    </script>
  </body>
</html>

